
\documentclass[11pt]{article}
%\linespread{1.1}
\usepackage{graphicx,import}
\usepackage{amsmath}
\usepackage{setspace}
\usepackage{color}
\usepackage{float}
\usepackage[inkscapelatex=false,inkscapearea=page]{svg}
\onehalfspacing
%\doublespacing

\title {Architecture and Open Queue Model \\ \bigskip \large Thesis}
\author {Silvio Dei Giudici, Marco Morella, Mattia Nicolella}
\date{26 September 2020}

\begin{document}
\maketitle
\section{Introduction}
This section will deal with the assumptions we have made so far and why we've made them. Alternatives will be described for the various possibilities.\\
\subsection{Assumptions}
\begin{enumerate}
\item \textbf{Assumption 2}: The only entity needing a storage system is the Central Node, in particular we are assuming that all other nodes receive information that can be processed, stored and aggregated in the RAM which will never be full. 
\item \textbf{Assumption 3}: more of a design choice for the moment, each node is modeled as a simple queue composed of CPU+RAM together, in future they will be extended and may need more component and a review of the entire queue model.
\item \textbf{Assumption 4}: In this first stage we won't be holding account of the fault tolerance of the system, in particular we are not considering duplication of the data not in storaging neither in multiple link sending.
\end{enumerate}

\section{System functioning and message flow}
The system is composed by:
\begin{itemize}
\item Central Node: core of the operations, all transitions-command couples will arrive to it to be logged, all telemetries must arrive to him then be aggregated, analyzed and stored on its disk. It manages all regional nodes. When a transition message reaches the central node it will need to generate a command in response.
\item Regional Node: transitions that need a regional level command will reach this and all transitions-command couples fixed in local level will be forwarded here to be sent in batch to the central node. Telemetries will flow through here to be aggregated and sent to the central node. A regional node manages a subset of all local nodes, disjoint from any other regional node domain.
\item Local Node: all transitions needing a local fix will go through them and be forwarded as a transition-command couple to the regional node. Also all transitions needing a regional or central level fix will be forwarded from here. A local node manages a subset of all actuators and sensors, disjoint from any other local node.
\item Actuator: commands will reach the actuators for a state change in the system, they can also send transitions to the higher levels when their state is changed without receiving a command message .
\item Sensor: periodically will generate telemetry messages and send them to the local level to be forwarded up to the central node, also will generate and send transition messages when their state is changed. They only send, never receive.
\end{itemize}
Both local and regional nodes need an acknowledgement reply from the higher level, respectively regional and central nodes. \\
All aggregations we talked about are determinated by parameters that will be given.\\
There is no duplication in sent messages.\\ 
All message types will be throughly analyzed in the Classes section.\\

\section{Structural scheme}
This section will explain how the structural scheme for the system is made and its project's choices.\\
In the model we are going to show, we used as connection between the upper level node and the lower level ones consists of a WAN connecting the upper level router to all lower level ones.\\
\begin{figure}[H]
	\hspace*{-3.75cm}
	\centering
  \frame{\includesvg[width=20cm]{structural_scheme_central_regional}}
  \caption{Focus on Central and Regional nodes}
\end{figure}
\begin{figure}[H]
	\hspace*{-3.75cm}
	\frame{\includesvg[width=20cm]{structural_scheme_local}}
	\caption{Focus on Regional and Local nodes}
\end{figure}
Figure 1 represents the connection between Central and Regional nodes, while Figure 2 shows the connection between Regional and Local. We can  see that lower level router is used as an interface for lower level nodes to receive and send messages to the upper level WAN which then forwards to the node. \\
\begin{figure}[H]
	\hspace*{-3.75cm}
  \frame{\includesvg[width=20cm]{structural_scheme_local_sensor}}
  \caption{Focus on Local nodes and end points}
\end{figure}
Instead in figure 3, which displays the connection between Local nodes and the end points of the edge system, namely actuators and sensors, one LAN is used for each type of connection technology, in this case MANET and WIRELESS but more types can be added, both spanning between end points and their respective upper level node.\\
The whole scheme:
\begin{figure}[H]
	\hspace*{-3.75cm}
	\frame{\includesvg[width=20cm]{structural_scheme_complete}}
  \caption{Structural scheme}
\end{figure}

\section{Queues Scheme and Formulas}
The following open queue scheme will be divided in segments during the analysis of each queue.
\begin{figure}[H]
	\vspace*{-0.5cm}
	\hspace*{-3.5cm}
	\centering
	\frame{\includesvg[width=25cm, height=19cm]{queue_network_wan}}
	\caption{The open queue scheme}
\end{figure}
\subsection{Classes}
Based on the specifics and the architecture, we opted for a multi-class open queueing model, in particular at the moment we have three different classes going through the system:
\begin{itemize}
\item t: telemetry events, where a sensors sends to its superior the data it has periodically, this data then will be aggregated at each level up until the central node.
\item e: transition events, which are sent by actuators or sensors when their state changes.
\item c: command events, generated by local, regional or central nodes, in response to a transition message which reached it from an actuator or sensor.
\item bs: batch send, generated by the regional nodes periodically to send to the disk aggregated data about the transition-command pairs.
\end{itemize}
Another type of message flowing through the network is a reply message but since they are triggered only by transition events we aggregated them in the visits.
Due to the nature of this kind of open queueing model, the formulas regarding Utilization factor, system demand and response time are very similar for the components.

\subsection{Notation}
We will deline the notation in the following formulas:
Since the structure of the network is very different between the branches of the tree, we need a notation that express how many (and which) nodes, sensors and actuators we have in each branch:
\begin{itemize}
\item $R$, is the set of regional nodes in the network. Every element in the set is express through an unique number.
\item $L^{\{i\}}$, is the set of local nodes that have in common the same regional node with identifier $i$.
\item $LAN^{\{i,j\}}$, is the set of lan's types that the local node $j$ (which belongs to the branch of regional node $i$) is connected to.
\item $S^{\{i,j,k\}}$, is the set of sensors' types that are placed in the LAN $k$ (which belongs to the $j$ local node in the $i$ regional node).
\item $A^{\{i,j,k\}}$, is the set of actuators' types that are placed in the LAN $k$ (which belongs to the $j$ local node in the $i$ regional node).
\item $S^{\{i,j,k\}}_{t}$, is the set of sensors which are of type $t$, placed in the LAN $k$ (which belongs to the $j$ local node in the $i$ regional node).
\item $A^{\{i,j,k\}}_{t}$, is the set of actuators which are of type $t$, placed in the LAN $k$ (which belongs to the $j$ local node in the $i$ regional node).
\end{itemize}
Now for the parameters we are going to use:
\begin{itemize}
\item $\lambda_t$, $\lambda_e$, $\lambda_c$: $\lambda$ is the arrival rate, respectively for the data type telemetry, transition and command.
\item $V$: mean number of visits.
\item $S$: service time.
\item $D$: service demand.
\item $U$: utilization factor.
\item $R$: response time.
\end{itemize}
The elements we are going to analyze are:
\begin{itemize}
\item cn : central node.
\item cns : central node storage
\item rn : regional node.
\item ln : local node.
\item li : lan in.
\item lo : lan out.
\end{itemize}
We will navigate the queue network starting from the sensors and actuators until reaching the central node.

\begin{figure}[H]
	\centering
	\frame{\includesvg[width=20cm, height=17cm]{queue_network_wireless_manet}}
	\caption{Focus on actuators, sensors,  local nodes, wireless and MANET LANs}
\end{figure}

\subsection{Actuators and Sensors}
Sensors at the moment don't receive any command, we still have drawn them as queues for future extensions. Conversely, actuators are modeled as queues since they can receive command from the central node or from the primary/secondary node where they are connected in response to a transition event.\\
Regarding the sensors, $\lambda_{s,t}$ and $\lambda_{s,e}$ are the rates at which the sensor sends a telemetry or a transition message respectively. The same is valid for the transition events rate of the actuators with $\lambda_{a,e}$.\\

%NEWWWW PARTTTTTT
Before going to the main formula we need to do some pre-computation.
%Let's suppose that we are in a branch of the system in which we belong to the $i$ regional node, $j$ local node and $k$ LAN.

%Firstly let's compute the number of actuators in this branch for each type $t$ of actuator:
%\begin{equation}
%    a_{t} = \sum_{\forall m,n,s \ | \ m \in R \ \land \ n \in L^{\{m\}} \ \land \ s \in LAN^{\{m, n\}}}{ | A^{\{m, n, s\}}_{t} | }
%\end{equation}

Firstly we need the set of actuators' types in all the system, where T is simply the sum of all actuators of all types:
%Se volete in questa parte dite direttamente a parole che T Ã¨ l'insieme di tutti i tipi di attuatori del sistema
\begin{equation}
    T = t \  \ (\forall m,n,s \ | \ m \in R \ \land \ n \in L^{\{m\}} \ \land \ s \in LAN^{\{m, n\}} \land t \in A^{\{m,n,s\}})
\end{equation}

Then let's compute the number of actuators in all the system's branches for each type $t \in T$ of actuator in the system:
\begin{equation}
    a'_{t} = \sum_{\forall m,n,s \ | \ m \in R \ \land \ n \in L^{\{m\}} \ \land \ s \in LAN^{\{m, n\}}}{ |A^{\{m, n, s\}}_{t}| }
\end{equation}


Also we need to denote the probability of each type of actuator to receive a command. Indeed, the probability to receive a command it's not evenly distributed over the actuators' types, so there may be the case that a type of actuator receives more commands with respect to another type.
For this reason we denote $p_t$ the probability associated to the $t$ type of actuator.
Since when a command is generated it must be delivered to at least an actuator, we need to specify that the sum of all type's probabilities is 1:
\begin{equation}
    \sum_{t \in T}{p_t} = 1
\end{equation}
Furthermore we will need two more sets:
\begin{itemize}
\item $T''$ : the set of all actuators managed by the regional node our local node refers to.
\item $T'''$ the set of all actuators managed by our local node.
\end{itemize}
Now we are ready to do the real computation. Denoting $w \in T$ as the type of the actuator that we are considering, we can write:

\begin{equation}
	\begin{array}{l}
		V_{a,c} = 1 \\
		
		\lambda_{a, c} = prob_{cmd,cn} * \lambda_{cn, c} * \frac{p_{w}}{\sum\limits_{t \in T}{a'_{t} * p_{t}}} + prob_{cmd,rn} * \lambda_{rn, c} *\frac{p_{w}}{\sum\limits_{t \in T''}{a'_{t} * p_{t}}} + prob_{cmd,ln} * \lambda_{ln, c} * \frac{p_{w}}{\sum\limits_{t \in T'''}{a'_{t} * p_{t}}}   \\
	\end{array}
\end{equation}
The command event formula will be throughly explained in the next section, as a brief explanation it is composed by three members, each representing the case of a different level node sending the command event to the single actuator, indeed we see each term is composed by the probability of a command event from a central node to be generate, multiplied its rate and the weighted ratio between the single actuator's probability of receiving and all actuators. The other two terms are similar but regional and local nodes have a smaller reachable set of actuators.\\
From the previous formulas and the open queue model we can compute the Service Demand, Utilization factor and Response time.
\begin{equation}
	\begin{array}{l}
		D_{a, c} = V_{a, c} * S_{a, c} \\
		U_{a, c} = \lambda_{a, c} * D_{a, c} \\
		R_{a, c} = \frac{D_{a, c}}{1 - U_{a,c}} \\
	\end{array}
\end{equation}

%END NEW PART


\subsection{LANs}
This part will deal will all kind of LANs available in the lower level, the formulas are similar so we will show a general one.\\
%NEW PARTTTTTT
Before going to the main formula we need to do some pre-computation.
Let's suppose that we are in a branch of the system in which we belong to the $i$ regional node, $j$ local node and $k$ LAN.

Firstly we need the set of actuators' types in all the system:
%Se volete in questa parte dite direttamente a parole che T Ã¨ l'insieme di tutti i tipi di attuatori del sistema
\begin{equation}
    T = t \ | \ (\forall m,n,s \ | \ m \in R \ \land \ n \in L^{\{m\}} \ \land \ s \in LAN^{\{m, n\}} \land t \in A^{\{m,n,s\}})
\end{equation}

Now let's compute the number of actuators in this branch for each type $t \in T$ of actuator:
\begin{equation}
    a_{t} = | A^{\{i, j, k\}}_{t} | 
\end{equation}

And this is the set of types on this branch:
\begin{equation}
    T' = | A^{\{i, j, k\}} | 
\end{equation}
Furthermore we will use a set T'' which is composed of the actuators in the sub tree managed by the regional node managing our local node.\\
And the set T''' which are the actuators managed by our local node.\\


Then let's compute the number of actuators in all the system's branches for each type $t \in T$ of actuator in the system:
\begin{equation}
    a'_{t} = \sum_{\forall m,n,s \ | \ m \in R \ \land \ n \in L^{\{m\}} \ \land \ s \in LAN^{\{m, n\}}}{ |A^{\{m, n, s\}}_{t}| }
\end{equation}


Also we need to denote the probability of each type of actuator to receive a command. Indeed, the probability to receive a command it's not evenly distributed over the actuators' types, so there may be the case that a type of actuator receives more commands with respect to another type.
For this reason we denote $p_t$ the probability associated to the $t$ type of actuator.
Since when a command is generated it must be delivered to at least an actuator, we need to specify that the sum of all type's probabilities is 1:
\begin{equation}
    \sum_{t \in T}{p_t} = 1
\end{equation}

Now we are ready to do the real computation. Denoting with $\lambda^{\{w\}}_{s, t}$ the arrival rate from the sensor of type $w \in T$, first for the whole LAN: 

\begin{equation}
    \begin{array}{l}
        V_{LAN, t} = 1 \\
        V_{LAN, e} = 2 \\ %reply
        V_{LAN,c} = 1 \\
        \lambda_{LAN, t} = \sum\limits_{w \in T}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, t}}  \\
        \lambda_{LAN, e} = \sum\limits_{w \in T}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, e}} + \sum\limits_{w \in T}{| A^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{a, e}}\\
		\lambda_{LAN, c} = prob_{cmd,cn} * \lambda_{cn, c} * \frac{\sum\limits_{t \in T'}{a_{t} * p_{t}}}{\sum\limits_{t \in T}{a'_{t} * p_{t}}} + prob_{cmd,rn} * \lambda_{rn, c} *\frac{\sum\limits_{t \in T'}{a_{t} * p_{t}}}{\sum\limits_{t \in T''}{a'_{t} * p_{t}}}  + prob_{cmd,ln} * \lambda_{ln, c} * \frac{\sum\limits_{t \in T''}{a_{t} * p_{t}}}{\sum\limits_{t \in T'''}{a'_{t} * p_{t}}}  \\\

    \end{array}
\end{equation}
We will explain the lambda formulas since from now on we will see some iterations of them that are simpler so explaining these ones should suffice.\\
The telemetries are straightforward, fixed our lan k, the local node j and the regional node i, the total rate over the network is given by the composition of all sensors sending data over this lan thus we multiply the number of each type of sensors with their rate.\\
The transition events are given by the sum of two elements, the first one representing the rate of all sensors in this lan and the second the rate of all actuators.\\
By the approach we are using on command events, the rate of command events over the lan is given by the sum of three terms, the first one is composed of the probability of a command event being generated from the central node, the rate of generation of those events multiplied by the ratio of the number of actuators in this lan over all actuators in the system, which are the ones that can be targeted by the central with a command event.\\
Likewise the other two terms reflect the cases in which respectively the regional node and the local node generate those events.\\
The ratios are weighted by the type of actuator since each type has a different probability of receiving a command message.\\
Dividing the LAN in Lan In and Out as we modeled them, we see Lan In having:
\begin{equation}
    \begin{array}{l}
        V_{li, e} = 1 \\ %reply
        V_{li,c} = 1 \\
        \lambda_{li, e} = \sum\limits_{w \in T}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, e}} + \sum\limits_{w \in T}{| A^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{a, e}}\\
		\lambda_{li, c} = prob_{cmd,cn} * \lambda_{cn, c} * \frac{\sum\limits_{t \in T'}{a_{t} * p_{t}}}{\sum\limits_{t \in T}{a'_{t} * p_{t}}} + prob_{cmd,rn} * \lambda_{rn, c} *\frac{\sum\limits_{t \in T'}{a_{t} * p_{t}}}{\sum\limits_{t \in T''}{a'_{t} * p_{t}}}  + prob_{cmd,ln} * \lambda_{ln, c} * \frac{\sum\limits_{t \in T''}{a_{t} * p_{t}}}{\sum\limits_{t \in T'''}{a'_{t} * p_{t}}}  \\\

    \end{array}
\end{equation}
Indeed the Lan In receives only command events and the replies to transition events sent on the lan out by actuators and sensors.\\
Now Lan Out, which will send both transitions and telemetries:
\begin{equation}
    \begin{array}{l}
        V_{lo, t} = 1 \\
        V_{lo, e} = 1 \\ %reply
        \lambda_{lo, t} = \sum\limits_{w \in T}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, t}}  \\
        \lambda_{lo, e} = \sum\limits_{w \in T}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, e}} + \sum\limits_{w \in T}{| A^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{a, e}}\\


    \end{array}
\end{equation}
%END NEW PART

From the previous formulas and the open queue model we can compute the Service Demand, Utilization factor and Response time. Formulas for Lan Out are specular.
\begin{equation}
    \begin{array}{l}
        D_{li, t} = V_{li, t} * S_{li, t} \\
        D_{li, e} = V_{li, e} * S_{li, e} \\
        D_{li, c} = V_{li, c} * S_{li, c} \\
        U_{li, t} = \lambda_{li, t} * D_{li, t} \\
        U_{li, e} = \lambda_{li, e} * D_{li, e} \\
        U_{li, c} = \lambda_{li, c} * D_{li, c} \\
        U_{li} = U_{wl, t} + U_{li, e} + U_{li, c} \\
        R_{li, t} = \frac{D_{li, t}}{1 - U_{li}} \\
        R_{li, e} = \frac{D_{li, e}}{1 - U_{li}} \\
        R_{li, c} = \frac{D_{li, c}}{1 - U_{li}} \\
    \end{array}
\end{equation}

\subsection{Local Node}
Taken a local node j, and its upper level regional node i, remembering the definition of $T$,$T''$ and $T'''$ from the previous section and modifying the definition of $T'$ by amplyfing the branch to include all LANs managed by this local node i we will define the new formulas.\\
The main difference here is that we don't have a fixed LAN so we need k to span across all LANs of the local node.
\begin{equation}
    \begin{array}{l}
        V_{ln, t} = 1 \\
        V_{ln, e} = 2 \\ %reply
        V_{ln,c} = 1 \\
        \lambda_{ln, t} = \sum\limits_{w \in T,k \in LAN^{\{i,j)}}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, t}}  \\
        \lambda_{ln, e} = \sum\limits_{w \in T,k \in LAN^{\{i,j)}}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, e}} + \sum\limits_{w \in T,k \in LAN^{\{i,j)}}{| A^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{a, e}}\\
		\lambda_{ln, c} = prob_{cmd,cn} * \lambda_{cn, c} * \frac{\sum\limits_{t \in T'}{a_{t} * p_{t}}}{\sum\limits_{t \in T}{a'_{t} * p_{t}}} + prob_{cmd,rn} * \lambda_{rn, c} *\frac{\sum\limits_{t \in T'}{a_{t} * p_{t}}}{\sum\limits_{t \in T''}{a'_{t} * p_{t}}}  + prob_{cmd,ln} * \lambda_{ln, c} * \frac{\sum\limits_{t \in T''}{a_{t} * p_{t}}}{\sum\limits_{t \in T'''}{a'_{t} * p_{t}}}  \\\

    \end{array}
\end{equation}
From the previous formulas and the open queue model we can compute the Service Demand, Utilization factor and Response time.
\begin{equation}
    \begin{array}{l}
        D_{pn, t} = V_{pn, t} * S_{pn, t} \\
        D_{pn, e} = V_{pn, e} * S_{pn, e} \\
        D_{pn, c} = V_{pn, c} * S_{pn, c} \\
        U_{pn, t} = \lambda_{pn, t} * D_{pn, t} \\
        U_{pn, e} = \lambda_{pn, e} * D_{pn, e} \\
        U_{pn, c} = \lambda_{pn, c} * D_{pn, c} \\
        U_{pn} = U_{pn, t} + U_{pn, e} + U_{pn, c} \\
        R_{pn, t} = \frac{D_{pn, t}}{1 - U_{pn}} \\
        R_{pn, e} = \frac{D_{pn, e}}{1 - U_{pn}} \\
        R_{pn, c} = \frac{D_{pn, c}}{1 - U_{pn}} \\
    \end{array}
\end{equation}
\subsection{WAN}
Since the WAN is an external object that we decided to model as a delay, we will consider it in the response time functions but it won't have formulas of its own.
\subsection{Regional Node}
As for the local node, we fix the regional node i while k and j will be free variables. We will extended again the definition of $T'$.\\
Regarding telemetry and transitions, we will also need to iterate over all local nodes below the regional node i.\\
The main difference in the command rate will be that we won't notice a local level fix in the command arrival rate.
\begin{equation}
	\begin{array}{l}
		V_{rn, t} = 1 \\
		V_{rn, e} = 2 \\ %reply
		V_{rn,c} = 1 \\
        \lambda_{rn, t} = \sum\limits_{w \in T,k \in LAN^{\{i,j)},j \in L^i}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, t}}  \\
        \lambda_{rn, e} = \sum\limits_{w \in T,k \in LAN^{\{i,j)},j \in L^i}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, e}} + \sum\limits_{w \in T,k \in LAN^{\{i,j}),j \in L^i}{| A^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{a, e}}\\
		\lambda_{rn, c} = prob_{cmd,cn} * \lambda_{cn, c} * \frac{\sum\limits_{t \in T'}{a_{t} * p_{t}}}{\sum\limits_{t \in T}{a'_{t} * p_{t}}} + prob_{cmd,rn} * \lambda_{rn, c} *\frac{\sum\limits_{t \in T'}{a_{t} * p_{t}}}{\sum\limits_{t \in T''}{a'_{t} * p_{t}}} \\\

	\end{array}
\end{equation}
From the previous formulas and the open queue model we can compute the Service Demand, Utilization factor and Response time.
\begin{equation}
	\begin{array}{l}
		D_{rn, t} = V_{rn, t} * S_{rn, t} \\
		D_{rn, e} = V_{rn, e} * S_{rn, e} \\
		D_{rn, c} = V_{rn, c} * S_{rn, c} \\
		U_{rn, t} = \lambda_{rn, t} * D_{rn, t} \\
		U_{rn, e} = \lambda_{rn, e} * D_{rn, e} \\
		U_{rn, c} = \lambda_{rn, c} * D_{rn, c} \\
		U_{rn} = U_{rn, t} + U_{rn, e} + U_{rn, c} \\
		R_{rn, t} = \frac{D_{rn, t}}{1 - U_{rn}} \\
		R_{rn, e} = \frac{D_{rn, e}}{1 - U_{rn}} \\
		R_{rn, c} = \frac{D_{rn, c}}{1 - U_{rn}} \\
	\end{array}
\end{equation}

\subsection{Central Node}
In the highest level, we will need to work over all the regional nodes, meaning that also i won't be fixed in the following formulas.\\
Central node command rate is oblivious to the regional node command events, thus the arrival rate is composed of only one element.
\begin{equation}
	\begin{array}{l}
		V_{cn, t} = 1 \\
		V_{cn, e} = 2 \\ %reply
		V_{cn,c} = 1 \\
        \lambda_{cn, t} = \sum\limits_{w \in T,k \in LAN^{\{i,j)},j \in L^i, i \in R}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, t}}  \\
        \lambda_{cn, e} = \sum\limits_{w \in T,k \in LAN^{\{i,j)},j \in L^i, i \in R}{| S^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{s, e}} + \sum\limits_{w \in T,k \in LAN^{\{i,j}),j \in L^i, i \in R}{| A^{\{i,j,k\}}_{w} | * \lambda^{\{w\}}_{a, e}}\\
		\lambda_{cn, c} = prob_{cmd,cn} * \lambda_{cn, c}
	\end{array}
\end{equation}
Obviously the ratio is not present in this case since it would be 1.\\
From the previous formulas and the open queue model we can compute the Service Demand, Utilization factor and Response time.
\begin{equation}
	\begin{array}{l}
		D_{cn, t} = V_{cn, t} * S_{cn, t} \\
		D_{cn, e} = V_{cn, e} * S_{cn, e} \\
		D_{cn, c} = V_{cn, c} * S_{cn, c} \\
		U_{cn, t} = \lambda_{cn, t} * D_{cn, t} \\
		U_{cn, e} = \lambda_{cn, e} * D_{cn, e} \\
		U_{cn, c} = \lambda_{cn, c} * D_{cn, c} \\
		U_{cn} = U_{cn, t} + U_{cn, e} + U_{cn, c} \\
		R_{cn, t} = \frac{D_{cn, t}}{1 - U_{cn}} \\
		R_{cn, e} = \frac{D_{cn, e}}{1 - U_{cn}} \\
		R_{cn, c} = \frac{D_{cn, c}}{1 - U_{cn}} \\
	\end{array}
\end{equation}

\subsubsection{Central node storage system}
In this first draft, the central node storage system is not characterized with a specific system(RAID 1-5, etc) and it is modeled as a simple queue filled by the central node.\\
Since the central node will do some aggregation and computations on the telemetry messages received by the regional nodes, the rate arriving on the disk will be divided by the aggregation parameter of the central node.\\

\begin{equation}
	\begin{array}{l}
		V_{cns, t} = 1 \\
		V_{cns, e} = 1 \\
		\lambda_{cns, t} = \frac{\lambda_{cn,t}}{aggr_{cn}} \\
		\lambda_{cns, e} = \lambda_{cn,e} \\
	\end{array}
\end{equation}
From the previous formulas and the open queue model we can compute the Service Demand, Utilization factor and Response time.
\begin{equation}
	\begin{array}{l}
		D_{cns, t} = V_{cns, t} * S_{cns, t} \\
		D_{cns, e} = V_{cns, e} * S_{cns, e} \\
		U_{cns, t} = \lambda_{cns, t} * D_{cns, t} \\
		U_{csn, e} = \lambda_{cns, e} * D_{cns, e} \\
		U_{cns} = U_{cns, t} + U_{cns, e} \\
		R_{cns, t} = \frac{D_{cns, t}}{1 - U_{cns}} \\
		R_{cns, e} = \frac{D_{cns, e}}{1 - U_{cns}} \\
	\end{array}
\end{equation}

\end{document}
